<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mingle Prototype</title>
  <style>
    /* Make the scene occupy the full viewport */
    html, body { width: 100%; height: 100%; margin: 0; font-family: Arial, sans-serif; }
    a-scene { width: 100%; height: 100%; }
    #instructions {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      padding: 10px;
      z-index: 100;
    }
  </style>
  <!--
    Load A-Frame and supporting libraries *before* the scene so that all
    custom elements are registered when the HTML is parsed. The configuration
    script exposes whether the server was launched in debug mode.
  -->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/socket.io-client@4.7.2/dist/socket.io.min.js"></script>
  <script src="/config.js"></script>
</head>
<body>
  <div id="instructions">
    <p>Use WASD to move and mouse to look.</p>
    <p>Press P to toggle spectate mode.</p>
  </div>

  <!-- Main A-Frame scene. Removing 'embedded' allows full-screen rendering -->
  <!-- Disable the default loading screen so the environment appears even if the
       webcam stream takes a while to initialise. -->
  <a-scene loading-screen="enabled: false">
    <a-assets>
      <!--
        Include the video element used for the local webcam feed. The `muted`
        attribute ensures browsers allow autoplay which lets A-Frame finish
        loading instead of leaving the user on the default blue loading screen.
      -->
      <video id="localVideo" autoplay playsinline muted></video>
    </a-assets>

    <!-- Simple floor and lighting -->
    <a-plane rotation="-90 0 0" width="20" height="20" color="#7BC8A4"></a-plane>
    <a-entity light="type: ambient; intensity: 0.5"></a-entity>
    <a-entity light="type: directional; intensity: 0.8" position="0 1 1"></a-entity>

    <!-- Player entity that holds the camera and avatar. The avatar is hidden locally
         so it does not obstruct the view but still moves for remote clients. -->
    <a-entity id="player" position="0 1.6 0" wasd-controls="">
      <a-camera id="playerCamera" look-controls="pointerLockEnabled: true"></a-camera>
      <a-box id="avatar" position="0 0 0" width="1" height="1" depth="0.1" material="src:#localVideo" visible="false"></a-box>
    </a-entity>

    <!-- Spectator camera fixed at a high corner for observing during tests -->
    <a-camera id="spectateCam" position="5 8 5" rotation="-30 -45 0" visible="false"></a-camera>
  </a-scene>

  <!-- Client logic is loaded last once the DOM and libraries are ready -->
  <script src="js/mingle_client.js"></script>
</body>
</html>
