<!DOCTYPE html>
<!--
  world_admin.html
  Mini README:
  - Purpose: provide a simple admin interface to view and update world settings
    and upload avatar assets.
  - Structure:
    1. Navbar reused across Mingle pages
    2. Instructional form for admin token and world configuration values
    3. Fields for world design (geometry and colour)
    4. Avatar asset uploads for body and TV models with scale/UV metadata
    5. Uploaded asset listing with thumbnails and preview configuration
    6. Client-side script to load and save settings via the secure API
  - Notes: requires the server to be started with ADMIN_TOKEN for access.
-->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>World Administration - Mingle</title>
  <style>
    html, body { margin:0; font-family: Arial, sans-serif; }
    nav {
      position: fixed; top:0; left:0; right:0; height:50px;
      background:#333; color:#fff; display:flex;
      justify-content: space-between; align-items:center;
      padding:0 10px; z-index:100;
    }
    nav a { color:#fff; text-decoration:none; font-weight:bold; }
    .profile-menu { position:relative; }
    .profile-button { width:40px; height:40px; border-radius:20px; cursor:pointer; }
    .dropdown { position:absolute; right:0; top:50px; background:#fff; color:#333; list-style:none; padding:0; margin:0; border:1px solid #ccc; display:none; min-width:180px; }
    .dropdown li a { display:block; padding:10px 15px; color:#333; }
    .dropdown li a:hover { background:#f0f0f0; }
    .dropdown.show { display:block; }
    main { padding:70px 10px; }
    label { display:block; margin-top:10px; }
    input, textarea { width:100%; padding:8px; margin-top:5px; box-sizing:border-box; }
    button { margin-top:15px; padding:10px 15px; }
  </style>
  <script src="/config.js"></script>
</head>
<body>
  <nav>
    <div><a href="/index.html">Mingle</a></div>
    <div class="profile-menu">
      <img src="https://via.placeholder.com/40" alt="Profile" id="profileButton" class="profile-button" />
      <ul id="profileDropdown" class="dropdown">
        <li><a href="manage_profiles.html">Manage Profiles</a></li>
        <li><a href="learning_zone.html">Learning Zone</a></li>
        <li><a href="my_details.html">My Details</a></li>
        <li><a href="subscription_details.html">Subscription Details</a></li>
        <li><a href="manage_users.html">Manage Users</a></li>
        <li><a href="#" id="signOut">Sign out</a></li>
      </ul>
    </div>
  </nav>
  <main>
    <h1>World Configuration</h1>
    <p>Enter the admin token and adjust the values below to configure the shared world.</p>
    <label for="token">Admin Token</label>
    <input type="password" id="token" placeholder="Required" />
    <label for="worldName">World Name</label>
    <input type="text" id="worldName" placeholder="Mingle World" />
    <label for="maxParticipants">Max Participants</label>
    <input type="number" id="maxParticipants" min="1" value="20" />
    <label for="welcomeMessage">Welcome Message</label>
    <textarea id="welcomeMessage" rows="3" placeholder="Welcome to Mingle"></textarea>
    <label for="worldGeometry">World Geometry</label>
    <select id="worldGeometry">
      <option value="plane">Plane</option>
      <option value="cube">Cube</option>
      <option value="sphere">Sphere</option>
    </select>
    <label for="worldColor">World Colour</label>
    <input type="color" id="worldColor" value="#00aaff" />
    <button id="loadBtn">Load Current Config</button>
    <button id="saveBtn">Save Config</button>

    <h2>Avatar Assets</h2>
    <p>Upload GLB models for the default avatar body and TV. UV values range from 0 to 1.</p>

    <section id="bodyAsset">
      <h3>Body Model</h3>
      <label for="bodyFile">Body GLB</label>
      <input type="file" id="bodyFile" accept=".glb" />
      <label for="bodyScale">Body Scale</label>
      <input type="number" id="bodyScale" step="0.1" value="1" />
      <button id="uploadBodyBtn">Upload Body</button>
    </section>

      <section id="tvAsset">
      <h3>TV Model</h3>
      <label for="tvFile">TV GLB</label>
      <input type="file" id="tvFile" accept=".glb" />
      <label for="tvScale">TV Scale</label>
      <input type="number" id="tvScale" step="0.1" value="1" />
      <fieldset>
        <legend>Screen UV Region</legend>
        <label for="screenX">X</label>
        <input type="number" id="screenX" step="0.01" min="0" max="1" value="0" />
        <label for="screenY">Y</label>
        <input type="number" id="screenY" step="0.01" min="0" max="1" value="0" />
        <label for="screenW">Width</label>
        <input type="number" id="screenW" step="0.01" min="0" max="1" value="1" />
        <label for="screenH">Height</label>
        <input type="number" id="screenH" step="0.01" min="0" max="1" value="1" />
        <canvas id="screenPreview" width="200" height="200" style="border:1px solid #ccc; display:block; margin-top:10px;"></canvas>
      </fieldset>
        <button id="uploadTVBtn">Upload TV</button>
      </section>

      <h2>Uploaded Assets</h2>
      <p>Select a body and TV to preview their alignment. Thumbnails use your uploaded models.</p>
      <div id="assetLists" style="display:flex; gap:20px; flex-wrap:wrap;"></div>

      <section id="previewSection" style="margin-top:20px;">
        <h3>Body / TV Preview</h3>
        <div style="display:flex; flex-direction:column; align-items:flex-start;">
          <canvas id="previewCanvas" width="400" height="400" style="border:1px solid #ccc;"></canvas>
          <div style="margin-top:10px;">
            <label>Body Scale <input type="range" id="bodyScaleRange" min="0.1" max="5" step="0.1" value="1"></label>
            <label>TV Scale <input type="range" id="tvScaleRange" min="0.1" max="5" step="0.1" value="1"></label>
            <label>TV X <input type="range" id="tvPosX" min="-2" max="2" step="0.01" value="0"></label>
            <label>TV Y <input type="range" id="tvPosY" min="-2" max="2" step="0.01" value="0"></label>
            <label>TV Z <input type="range" id="tvPosZ" min="-2" max="2" step="0.01" value="0"></label>
            <button id="savePlacementBtn">Save Selection & Placement</button>
          </div>
        </div>
      </section>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script src="js/mingle_navbar.js"></script>
    <script src="js/world_admin.js"></script>
  </body>
</html>
